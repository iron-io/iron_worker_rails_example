<h1>Scheduled tasks</h1>

<h3>Schedule Task</h3>
<%= form_tag(schedules_path) do %>
    <table>
      <tr>
        <td><%= label_tag(:worker_name) %></td>
        <td><%= text_field_tag(:worker_name, "HelloWorker") %></td>
      </tr>
      <tr>
        <td><%= label_tag(:schedule_params) %></td>
        <td><%= text_field_tag(:schedule_params, '{"text":"sample"}') %></td>
      </tr>
      <tr>
        <td><%= label_tag(:run_after) %></td>
        <td><%= select_tag :run_after, options_for_select([5, 10, 15], 1) %> seconds</td>
      </tr>
      <tr>
        <td><%= label_tag(:stop_after) %></td>
        <td><%= select_tag :stop_after, options_for_select([10, 15, 20], 1) %> seconds</td>
      </tr>
      <tr>
        <td><%= label_tag(:run_every) %></td>
        <td><%= select_tag :run_every, options_for_select([60, 120, 180], 1) %> seconds</td>
      </tr>
      <tr>
        <td><%= label_tag(:run_times) %></td>
        <td><%= select_tag :run_times, options_for_select([5, 10, 15], 1) %></td>
      </tr>
      <tr>
        <td><%= label_tag(:priority) %></td>
        <td><%= select_tag :priority, options_for_select([0, 1, 2], 1) %></td>
      </tr>
      <tr>
        <td><%= submit_tag("Schedule") %></td>
      </tr>
    </table>
<% end %>


<h3>List of scheduled tasks:</h3>
<% if !@schedules.empty? %>
    <table border="1">
      <thead>
      <tr>
        <td>Code Name</td>
        <td>Created at</td>
        <td>Status</td>
        <td>Start at</td>
        <td>Next start</td>
        <td>Actions</td>
      </tr>
      </thead>

      <% @schedules.each do |t| %>
          <tr>
            <td><%= t.code_name %></td>
            <td><%= t.created_at %></td>
            <td><%= t.status %></td>
            <td><%= t.start_at %></td>
            <td><%= t.next_start %></td>
            <td>
              <%= button_to "Cancel", cancel_schedule_path(t.id) %>
          </tr>
      <% end %>
    </table>
<% else %>
    <h5>There are now any active scheduled tasks, feel free to schedule new one</h5>
<% end %>

<%= link_to "Back", root_path %>