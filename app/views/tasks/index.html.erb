<h1>Tasks</h1>
<h3>Queue task</h3>
<%= form_tag(tasks_path) do %>
    <table>
      <tr>
        <td>
          <%= label_tag(:worker_name) %>
        </td>
        <td>
          <%= text_field_tag(:worker_name, "HelloWorker") %>
        </td>
      </tr>
      <tr>
        <td>
          <%= label_tag(:task_params) %>
        </td>
        <td>
          <%= text_field_tag(:task_params, '{"text":"sample"}') %>
        </td>
      </tr>
      <tr>
        <td>
          <%= label_tag(:delay) %>
        </td>
        <td>
          <%= select_tag :delay, options_for_select([5, 10, 15], 1) %>
        </td>
      </tr>
      <tr>
        <td>
          <%= label_tag(:task_timeout) %>
        </td>
        <td>
          <%= select_tag :task_timeout, options_for_select([5, 10, 15], 1) %>
        </td>
      </tr>
      <tr>
        <td colspan="2"><%= submit_tag("Queue") %></td>
      </tr>
    </table>
<% end %>

<h3>List of tasks:</h3>
<% if !@tasks.empty? %>
    <table border="1">
      <thead>
      <tr>
        <td>Code Name</td>
        <td>Created at</td>
        <td>Status</td>
        <td>Duration</td>
        <td>Log</td>
        <td>Actions</td>
      </tr>
      </thead>

      <% @tasks.each do |t| %>
          <tr>
            <td><%= t.code_name %></td>
            <td><%= t.created_at %></td>
            <td><%= t.status %></td>
            <td><%= t.duration %></td>
            <td><%= link_to "Log", log_task_path(t.id) %></td>
            <td>
              <%= button_to "Retry", retry_task_task_path(t.id) %>
              <%= button_to "Cancel", cancel_task_path(t.id) %>
              <%= button_to "Cancel all", cancel_all_task_path(t.code_id) %></td>
          </tr>
      <% end %>
    </table>
<% else %>
    <h5>There are now any tasks, feel free to queue new one</h5>
<% end %>
<p>
<%= link_to "Back", root_path %>